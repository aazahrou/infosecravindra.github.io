<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content=#fff name=theme-color><meta content="How to get started with many to many relationship in Laravel" name=description><meta content=" laravel,  relationships,  '" name=keywords><meta content="Ravindra Sisodia" name=author><meta content="Laravel Many to Many Relationship: Ravindra's Blog" property=og:title><meta content=https://infosecravindra.github.io/laravel/relationships/2019/04/23/laravel-many-to-many-relationship.html property=og:url><meta content="Ravindra's Blog" property=og:site_name><meta content=article property=og:type><meta content="How to get started with many to many relationship in Laravel" property=og:description><meta content="Ravindra Sisodia" property=article:author><meta content=laravel property=article:tag><meta content=relationships property=article:tag><meta content=2019-05-12T13:50:16Z property=article:published_time><meta content=https://infosecravindra.github.io/assets/images/posts/laravel/laravel-many-to-many-relationship.webp property=og:image itemprop=image><meta content=222225015360700 property=fb:app_id><title>Laravel Many to Many Relationship | Ravindra's Blog</title><link href=/assets/images/favicon/logo.webp rel=icon><link href=/manifest.json rel=manifest><link href=/assets/images/logo-192x192.png rel=apple-touch-icon><link href=https://fonts.gstatic.com/ rel=preconnect><link href=https://use.fontawesome.com/releases/v5.8.2/css/solid.css rel=stylesheet crossorigin=anonymous integrity=sha384-ioUrHig76ITq4aEJ67dHzTvqjsAP/7IzgwE7lgJcg2r7BRNGYSK0LwSmROzYtgzs><link href=https://use.fontawesome.com/releases/v5.8.2/css/brands.css rel=stylesheet crossorigin=anonymous integrity=sha384-i2PyM6FMpVnxjRPi0KW/xIS7hkeSznkllv+Hx/MtYDaHA5VcF0yL3KVlvzp8bWjQ><link href=https://use.fontawesome.com/releases/v5.8.2/css/fontawesome.css rel=stylesheet crossorigin=anonymous integrity=sha384-sri+NftO+0hcisDKgr287Y/1LVnInHJ1l+XC7+FOabmTTIK0HnE2ID+xxvJ21c5J><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel=stylesheet><link href=/assets/css/all.css rel=stylesheet></head><body class=layout-post><nav class="bg-white fixed-top mediumnavigation nav-down navbar navbar-expand-lg navbar-light shadow-sm"><div class="container pr-0"><a href=/ class=navbar-brand><img alt="Ravindra's Blog" class="align-top d-inline-block" src=/assets/images/favicon/logo.webp height=30 width=30>Ravindra's Blog</a><button aria-controls=navbarMediumish aria-expanded=false aria-label="Toggle navigation" class="btn-link navbar-toggler" data-target=#navbarMediumish data-toggle=collapse><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarMediumish><ul class="ml-auto navbar-nav"><li class=nav-item><a href=/index.html class=nav-link><i class="fas fa-home"></i>&nbsp;&nbsp;Home</a></li><li class=nav-item><a href=/cheatsheets class=nav-link><i class="fas fa-book"></i>&nbsp;&nbsp;Cheatsheets</a></li><li class=nav-item><a href=/portfolio class=nav-link><i class="fas fa-user"></i>&nbsp;&nbsp;Projects</a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" aria-expanded=false aria-haspopup=true data-toggle=dropdown id=navbarDropdown role=button><i class="fas fa-id-card"></i>&nbsp;&nbsp;Contact</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a href=mailto:rscipher001@gmail.com class=nav-link rel=noopener target=_blank><i class="fas fa-envelope"></i>&nbsp;&nbsp;Mail</a><div class=dropdown-divider></div><a href=https://www.github.com/InfoSecRavindra/ class=nav-link rel=noopener target=_blank><i class="fab fa-github"></i>&nbsp;&nbsp;GitHub</a><a href=https://www.linkedin.com/in/InfoSecRavindra/ class=nav-link rel=noopener target=_blank><i class="fab fa-linkedin"></i>&nbsp;&nbsp;LinkedIn</a><a href=https://www.youtube.com/c/EcoTechClubETC class=nav-link rel=noopener target=_blank><i class="fab fa-youtube"></i>&nbsp;&nbsp;YouTube</a><div class=dropdown-divider></div><a href=https://twitter.com/InfoSecRavindra class=nav-link rel=noopener target=_blank><i class="fab fa-twitter"></i>&nbsp;&nbsp;Twitter</a></div></li></ul></div></div></nav><div class=site-content><div class=container><div class=mainheading><h1 class=sitetitle>Ravindra's Blog</h1><p class=lead>Let's Secure Everything</p></div><div class=main-content><div class=container><div class=row><div class="col-md-2 pl-0"><div class=share><p>Share</p><ul><li class="ml-1 mr-1"><a href="https://facebook.com/sharer.php?u=https://infosecravindra.github.io/laravel/relationships/2019/04/23/laravel-many-to-many-relationship.html" target=_blank onclick="window.open(this.href, 'facebook-share');return false;"><i class="fab fa-facebook-f"></i></a></li><li class="ml-1 mr-1"><a href="https://twitter.com/intent/tweet?text=Laravel+Many+to+Many+Relationship&url=https://infosecravindra.github.io/laravel/relationships/2019/04/23/laravel-many-to-many-relationship.html" target=_blank onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://infosecravindra.github.io/laravel/relationships/2019/04/23/laravel-many-to-many-relationship.html" target=_blank onclick="window.open(this.href, 'linkedin-share');return false;"><i class="fab fa-linkedin-in"></i></a></li></ul><div class=sep></div><ul><li><a href=#disqus_thread class="small smoothscroll"></a></li></ul></div></div><div class="col-md-9 flex-first flex-md-unordered"><div class=mainheading><h1 class=posttitle>Laravel Many to Many Relationship</h1></div><img alt="Laravel Many to Many Relationship" class="featured-image img-fluid" src=https://infosecravindra.github.io/assets/images/posts/laravel/laravel-many-to-many-relationship.webp><div class=article-post><h1 id=getting-started>Getting Started</h1><p>Many to many relationship are awesome but they are little different from other type of relations, it this post we are going to see that how can we create many to many relationships in laravel and I am going to use<code class=highlighter-rouge>attribute</code>and<code class=highlighter-rouge>product</code>example because I am working on it. This is part of an e-commerce website where a product can have many attributes like color, size, etc and an attribute can belong to many products. First we will create our models and define relationships in our models.</p><div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code>php artisan make:model <span class=nt>-a</span> Product
php artisan make:model <span class=nt>-a</span> Attribute
</code></pre></div></div><p><code class=highlighter-rouge>-a</code>options creates model, migration, controller and Factory, if you don’t need factory then use<code class=highlighter-rouge>-mcr</code>instead<code class=highlighter-rouge>-a</code>.</p><p>Now let’s define relationships in our models</p><div class="highlighter-rouge language-php"><div class=highlight><pre class=highlight><code><span class=c1>// Product.php</span>
<span class=k>public</span> <span class=k>function</span> <span class=nf>attributes</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>belongsToMany</span><span class=p>(</span><span class=s1>'App\Attribute'</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></div><div class="highlighter-rouge language-php"><div class=highlight><pre class=highlight><code><span class=c1>// Attribute.php</span>
<span class=k>public</span> <span class=k>function</span> <span class=nf>products</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>belongsToMany</span><span class=p>(</span><span class=s1>'App\Product'</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></div><p>Feel free to add some columns to your migration files, I am going to skip that because we don’t need that. Since this is a m-2-m relationship we need an intermediate table to keep record of relationship, Naming convention uses model names alphabetically which means our table should be named<code class=highlighter-rouge>attribute_product</code>but you’re free to use something else but I will stick to the conventions for now, let’s create a new migration file.</p><div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code>php artisan make:migration create_attribute_product_table <span class=nt>--create</span><span class=o>=</span>attribute_product
</code></pre></div></div><p>Open your migration file and add these column to the schema</p><div class="highlighter-rouge language-php"><div class=highlight><pre class=highlight><code><span class=nx>Schema</span><span class=o>::</span><span class=na>create</span><span class=p>(</span><span class=s1>'attribute_product'</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>Blueprint</span> <span class=nv>$table</span><span class=p>)</span> <span class=p>{</span>
    <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>bigIncrements</span><span class=p>(</span><span class=s1>'id'</span><span class=p>);</span>

    <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>unsignedBigInteger</span><span class=p>(</span><span class=s1>'attribute_id'</span><span class=p>);</span>
    <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>foreign</span><span class=p>(</span><span class=s1>'attribute_id'</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>references</span><span class=p>(</span><span class=s1>'id'</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>on</span><span class=p>(</span><span class=s1>'attributes'</span><span class=p>);</span>

    <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>unsignedBigInteger</span><span class=p>(</span><span class=s1>'product_id'</span><span class=p>);</span>
    <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>foreign</span><span class=p>(</span><span class=s1>'product_id'</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>references</span><span class=p>(</span><span class=s1>'id'</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>on</span><span class=p>(</span><span class=s1>'products'</span><span class=p>);</span>

    <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>unique</span><span class=p>([</span><span class=s1>'attribute_id'</span><span class=p>,</span> <span class=s1>'product_id'</span><span class=p>]);</span>
<span class=p>});</span>
</code></pre></div></div><p>And we are done here, now you can retrieve all attribute for a product using<code class=highlighter-rouge>$product-&gt;attributes</code>and all product with an attribute using<code class=highlighter-rouge>$attribute-&gt;product</code>.</p></div><hr><p><span>Original:&nbsp;<time datetime=2019-04-23>23 Apr 2019</time></span><span class="clearfix float-right">Updated:&nbsp;<time datetime=2019-05-12>May 12, 2019</time></span></p><hr><div class=after-post-tags><ul class=tags><li><a href=/archives/posts_archive.html#laravel class=post-tag>laravel</a></li><li><a href=/archives/posts_archive.html#relationships class=post-tag>relationships</a></li></ul></div><div class="row PageNavigation d-flex font-weight-bold justify-content-between"><a href=https://infosecravindra.github.io/keyboard/shortcuts/2019/04/23/my-favorite-editor-shortcuts-for-faster-development.html class="col-md-6 d-block prev">&laquo; My Favorite Editor Shortcuts For Faster Development</a><a href=https://infosecravindra.github.io/laravel/validation/2019/04/25/custom-validation-rule-in-laravel.html class="col-md-6 d-block next text-lg-right">Custom Validation Rule in Laravel &raquo;</a><div class=clearfix></div></div></div></div></div><div class=container><div class="row justify-content-center mb-5" id=comments><div class="col-md-9 col-offset-1"><div id=disqus_thread></div><script src=/assets/js/disqus.js></script><noscript>Please enable JavaScript to view the<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></div></div></div><footer class=footer><div class=container><div class="row text-dark"><div class="col-md-6 col-sm-6 text-center text-lg-left">Copyright © 2019 Ravindra Sisodia</div><div class="col-md-6 col-sm-6 text-center text-lg-right"><a href=https://www.wowthemes.net class=text-dark rel=noopener target=_blank>Mediumish Theme</a>by WowThemes.net</div></div></div></footer></div><script src=https://code.jquery.com/jquery-3.4.1.min.js crossorigin=anonymous integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js defer crossorigin=anonymous integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM></script><script src=/assets/js/mediumish.js defer></script><script src=//infosecravindra-github-io.disqus.com/count.js defer id=dsq-count-scr></script><script src=/assets/js/service-worker-handler.js defer></script></body></html>